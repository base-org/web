"use strict";(self.webpackChunk_app_base_docs=self.webpackChunk_app_base_docs||[]).push([[9842],{30876:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var r=n(2784);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},d=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=u(n),m=o,h=c["".concat(s,".").concat(m)]||c[m]||p[m]||i;return n?r.createElement(h,a(a({ref:t},d),{},{components:n})):r.createElement(h,a({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,a=new Array(i);a[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:o,a[1]=l;for(var u=2;u<i;u++)a[u]=n[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},61776:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>u});var r=n(7896),o=(n(2784),n(30876));const i={title:"Control Structures",description:"Learn how to control code flow in Solidity.",hide_table_of_contents:!1},a=void 0,l={unversionedId:"docs/control-structures/control-structures",id:"docs/control-structures/control-structures",title:"Control Structures",description:"Learn how to control code flow in Solidity.",source:"@site/base-camp/docs/control-structures/control-structures.md",sourceDirName:"docs/control-structures",slug:"/docs/control-structures/",permalink:"/base-camp/docs/control-structures/",draft:!1,tags:[],version:"current",frontMatter:{title:"Control Structures",description:"Learn how to control code flow in Solidity.",hide_table_of_contents:!1},sidebar:"docs",previous:{title:"Require, Revert, and Error",permalink:"/base-camp/docs/control-structures/require-revert-error-vid"},next:{title:"Control Structures Exercise",permalink:"/base-camp/docs/control-structures/control-structures-exercise"}},s={},u=[{value:"Objectives",id:"objectives",level:2},{value:"Control Structures",id:"control-structures",level:2},{value:"Conditional Control Structure Examples",id:"conditional-control-structure-examples",level:3},{value:"Iterative Control Structures",id:"iterative-control-structures",level:3},{value:"Error Handling",id:"error-handling",level:2},{value:"Revert and Error",id:"revert-and-error",level:3},{value:"Require",id:"require",level:3},{value:"Assert and Panic",id:"assert-and-panic",level:3},{value:"Conclusion",id:"conclusion",level:2}],d={toc:u},c="wrapper";function p(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Solidity supports many familiar control structures, but these come with additional restrictions and considerations due to the cost of gas and the necessity of setting a maximum amount of gas that can be spent in a given transaction."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"objectives"},"Objectives"),(0,o.kt)("p",null,"By the end of this lesson you should be able to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Control code flow with ",(0,o.kt)("inlineCode",{parentName:"li"},"if"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"else"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"while"),", and ",(0,o.kt)("inlineCode",{parentName:"li"},"for")),(0,o.kt)("li",{parentName:"ul"},"List the unique constraints for control flow in Solidity"),(0,o.kt)("li",{parentName:"ul"},"Utilize ",(0,o.kt)("inlineCode",{parentName:"li"},"require")," to write a function that can only be used when a variable is set to ",(0,o.kt)("inlineCode",{parentName:"li"},"true")),(0,o.kt)("li",{parentName:"ul"},"Write a ",(0,o.kt)("inlineCode",{parentName:"li"},"revert")," statement to abort execution of a function in a specific state"),(0,o.kt)("li",{parentName:"ul"},"Utilize ",(0,o.kt)("inlineCode",{parentName:"li"},"error")," to control flow more efficiently than with ",(0,o.kt)("inlineCode",{parentName:"li"},"require"))),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"control-structures"},"Control Structures"),(0,o.kt)("p",null,"Solidity supports the basic conditional and iterative ",(0,o.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.17/control-structures.html"},"control structures")," found in other curly bracket languages, but it ",(0,o.kt)("strong",{parentName:"p"},"does not")," support more advanced statements such as ",(0,o.kt)("inlineCode",{parentName:"p"},"switch"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"forEach"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"in"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"of"),", etc."),(0,o.kt)("p",null,"Solidity does support ",(0,o.kt)("inlineCode",{parentName:"p"},"try"),"/",(0,o.kt)("inlineCode",{parentName:"p"},"catch"),", but only for calls to other contracts."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.17/yul.html"},"Yul")," is an intermediate-level language that can be embedded in Solidity contracts and is documented within the docs for Solidity. Yul ",(0,o.kt)("strong",{parentName:"p"},"does")," contain the ",(0,o.kt)("inlineCode",{parentName:"p"},"switch")," statement, which can confuse search results.")),(0,o.kt)("h3",{id:"conditional-control-structure-examples"},"Conditional Control Structure Examples"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"if"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"else if"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"else"),", statements work as expected. Curly brackets may be omitted for single-line bodies, but we recommend avoiding this as it is less explicit."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},'function ConditionalExample(uint _number) external pure returns (string memory) {\n    if(_number == 0) {\n        return "The number is zero.";\n    } else if(_number % 2 == 0) {\n        return "The number is even and greater than zero.";\n    } else {\n        return "The number is odd and is greater than zero.";\n    }\n}\n')),(0,o.kt)("h3",{id:"iterative-control-structures"},"Iterative Control Structures"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"while"),", ",(0,o.kt)("inlineCode",{parentName:"p"},"for"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"do"),", keywords function the same as in other languages. You can use ",(0,o.kt)("inlineCode",{parentName:"p"},"continue")," to skip the rest of a loop and start the next iteration. ",(0,o.kt)("inlineCode",{parentName:"p"},"break")," will terminate execution of the loop, and you can use ",(0,o.kt)("inlineCode",{parentName:"p"},"return")," to exit the function and return a value at any point."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"You can use ",(0,o.kt)("inlineCode",{parentName:"p"},"console.log")," by importing ",(0,o.kt)("inlineCode",{parentName:"p"},'import "hardhat/console.sol";'),". Doing so will require you to mark otherwise ",(0,o.kt)("inlineCode",{parentName:"p"},"pure")," contracts as ",(0,o.kt)("inlineCode",{parentName:"p"},"view"),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"uint times; // Default value is 0!\nfor(uint i = 0; i <= times; i++) {\n    console.log(i);\n}\n\nuint timesWithContinue;\nfor(uint i = 0; i <= timesWithContinue; i++) {\n    if(i % 2 == 1) {\n        continue;\n    }\n    console.log(i);\n}\n\nuint timesWithBreak;\nfor(uint i = 0; i <= timesWithBreak; i++) {\n    // Always stop at 7\n    if(i == 7) {\n        break;\n    }\n    console.log(i);\n}\n\nuint stopAt = 10;\nwhile(stopAt <= 10) {\n    console.log(i);\n    stopAt++;\n}\n\nuint doFor = 10;\ndo {\n    console.log(i);\n    doFor++;\n} while(doFor <= 10);\n")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"error-handling"},"Error Handling"),(0,o.kt)("p",null,"Solidity contains a set of relatively unique, built-in functions and keywords to handle ",(0,o.kt)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.17/control-structures.html#error-handling-assert-require-revert-and-exceptions"},"errors"),". They ensure certain requirements are met, and completely abort all execution of the function and revert any state changes that occurred during function execution. You can use these functions to help protect the security of your contracts and limit their execution."),(0,o.kt)("p",null,"The approach may seem different than in other environments. If an error occurs partly through a high-stakes transaction such as transferring millions of dollars of tokens, you ",(0,o.kt)("strong",{parentName:"p"},"do not")," want execution to carry on, partially complete, or swallow any errors."),(0,o.kt)("h3",{id:"revert-and-error"},"Revert and Error"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"revert")," keyword halts and reverses execution. It must be paired with a custom ",(0,o.kt)("inlineCode",{parentName:"p"},"error"),". Revert should be used to prevent operations that are logically valid, but should not be allowed for business reasons. It is ",(0,o.kt)("strong",{parentName:"p"},"not")," a bug if a ",(0,o.kt)("inlineCode",{parentName:"p"},"revert")," is triggered. Examples where ",(0,o.kt)("inlineCode",{parentName:"p"},"revert")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"error")," would be used to control operations include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Allowing only certain senders to access functionality"),(0,o.kt)("li",{parentName:"ul"},"Preventing the withdrawal of a deposit before a certain date"),(0,o.kt)("li",{parentName:"ul"},"Allowing inputs under certain state conditions and denying them under others")),(0,o.kt)("p",null,"Custom ",(0,o.kt)("inlineCode",{parentName:"p"},"error"),"s can be declared without parameters, but they are much more useful if you include them:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"error OddNumberSubmitted(uint _first, uint _second);\nfunction onlyAddEvenNumbers(uint _first, uint _second) public pure returns (uint) {\n    if(_first % 2 != 0 || _second % 2 != 0) {\n        revert OddNumberSubmitted(_first, _second);\n    }\n    return _first + _second;\n}\n")),(0,o.kt)("p",null,"When triggered, the ",(0,o.kt)("inlineCode",{parentName:"p"},"error")," provides the values in the parameters provided. This information is very useful when debugging, and/or to transmit information to the front end to share what has happened with the user:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},'call to HelloWorld.onlyAddEvenNumbers errored: VM error: revert.\n\nrevert\n    The transaction has been reverted to the initial state.\nError provided by the contract:\nOddNumberSubmitted\nParameters:\n{\n "_first": {\n  "value": "1"\n },\n "_second": {\n  "value": "2"\n }\n}\nDebug the transaction to get more information.\n')),(0,o.kt)("p",null,"You'll also encounter ",(0,o.kt)("inlineCode",{parentName:"p"},"revert")," used as a function, returning a string error. This legacy pattern has been retained to maintain compatibility with older contracts:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},'function oldRevertAddEvenNumbers(uint _first, uint _second) public pure returns (uint) {\n    if(_first % 2 != 0 || _second % 2 != 0) {\n        // Legacy use of revert, do not use\n        revert("One of the numbers is odd");\n    }\n    return _first + _second;\n}\n')),(0,o.kt)("p",null,"The error provided is less helpful:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},'call to HelloWorld.oldRevertAddEvenNumbers errored: VM error: revert.\n\nrevert\n    The transaction has been reverted to the initial state.\nThe reason provided by the contract: "One of the numbers is odd".\nDebug the transaction to get more information.\n')),(0,o.kt)("h3",{id:"require"},"Require"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"require")," function is falling out of favor because it uses more gas than the pattern above. You should still become familiar with it because it is present in innumerable contracts, tutorials, and examples."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"require")," takes a logical condition and a string error as arguments. It is more gas efficient to separate logical statements if they are not interdependent. In other words, don't use ",(0,o.kt)("inlineCode",{parentName:"p"},"&&")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"||")," in a ",(0,o.kt)("inlineCode",{parentName:"p"},"require")," if you can avoid it."),(0,o.kt)("p",null,"For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},'function requireAddEvenNumbers(uint _first, uint _second) public pure returns (uint) {\n    // Legacy pattern, do not use\n    require(_first % 2 == 0, "First number is not even");\n    require(_second % 2 != 0, "Second number is not even");\n\n    return _first + _second;\n}\n')),(0,o.kt)("p",null,"The output error message will be the first one that fails. If you were to submit ",(0,o.kt)("inlineCode",{parentName:"p"},"1"),", and ",(0,o.kt)("inlineCode",{parentName:"p"},"3")," to this function, the error will only contain the first message:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-test"},'call to HelloWorld.requireAddEvenNumbers errored: VM error: revert.\n\nrevert\n    The transaction has been reverted to the initial state.\nThe reason provided by the contract: "First number is not even".\nDebug the transaction to get more information.\n')),(0,o.kt)("h3",{id:"assert-and-panic"},"Assert and Panic"),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"assert")," keyword throws a ",(0,o.kt)("inlineCode",{parentName:"p"},"panic")," error if triggered. A ",(0,o.kt)("inlineCode",{parentName:"p"},"panic")," is the same type of error that is thrown if you try to divide by zero or access an array out-of-bounds. It is used for testing internal errors and should never be triggered by normal operations, even with flawed input. You have a bug that should be resolved if an assert throws an exception:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-solidity"},"function ProcessEvenNumber(uint _validatedInput) public pure {\n    // If assert triggers, input validation has failed.  This should never\n    // happen!\n    assert(_validatedInput % 2 == 0);\n    // Do something...\n}\n")),(0,o.kt)("p",null,"The output here isn't as helpful, so you may wish to use one of the patterns above instead."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"call to HelloWorld.ProcessEvenNumber errored: VM error: revert.\n\nrevert\n    The transaction has been reverted to the initial state.\nNote: The called function should be payable if you send value and the value you send should be less than your current balance.\nDebug the transaction to get more information.\n")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"In this lesson, you've learned how to control code flow with standard conditional and iterative operators. You've also learned about the unique keywords Solidity uses to generate errors and reset changes if one of them has been triggered. You've been exposed to both newer and legacy methods of writing errors, and learned the difference between ",(0,o.kt)("inlineCode",{parentName:"p"},"assert")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"require"),"."))}p.isMDXComponent=!0}}]);