"use strict";(self.webpackChunk_app_base_docs=self.webpackChunk_app_base_docs||[]).push([[4776],{82247:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>u});var a=n(14041);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},d="mdxType",y={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=s(n),m=r,u=d["".concat(c,".").concat(m)]||d[m]||y[m]||o;return n?a.createElement(u,i(i({ref:t},p),{},{components:n})):a.createElement(u,i({ref:t},p))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[d]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},21077:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>y,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(89575),r=(n(14041),n(82247));const o={title:"The New Keyword",description:"Learn to create a contract that creates other contracts.",hide_table_of_contents:!1},i=void 0,l={unversionedId:"docs/new-keyword/new-keyword-sbs",id:"docs/new-keyword/new-keyword-sbs",title:"The New Keyword",description:"Learn to create a contract that creates other contracts.",source:"@site/base-camp/docs/new-keyword/new-keyword-sbs.md",sourceDirName:"docs/new-keyword",slug:"/docs/new-keyword/new-keyword-sbs",permalink:"/base-camp/docs/new-keyword/new-keyword-sbs",draft:!1,tags:[],version:"current",frontMatter:{title:"The New Keyword",description:"Learn to create a contract that creates other contracts.",hide_table_of_contents:!1},sidebar:"docs",previous:{title:"Creating a `new` Contract",permalink:"/base-camp/docs/new-keyword/creating-a-new-contract-vid"},next:{title:"New Exercise",permalink:"/base-camp/docs/new-keyword/new-keyword-exercise"}},c={},s=[{value:"Objectives",id:"objectives",level:2},{value:"Creating a Simple Contract Factory",id:"creating-a-simple-contract-factory",level:2},{value:"Adding the Template",id:"adding-the-template",level:3},{value:"Creating a Factory",id:"creating-a-factory",level:3},{value:"Testing",id:"testing",level:3},{value:"Conclusion",id:"conclusion",level:2}],p={toc:s},d="wrapper";function y(e){let{components:t,...o}=e;return(0,r.yg)(d,(0,a.A)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("p",null,"You've seen the ",(0,r.yg)("inlineCode",{parentName:"p"},"new")," keyword and used it to instantiate ",(0,r.yg)("inlineCode",{parentName:"p"},"memory")," arrays with a size based on a variable. You can also use it to write a contract that ",(0,r.yg)("a",{parentName:"p",href:"https://docs.soliditylang.org/en/v0.8.17/control-structures.html?#creating-contracts-via-new"},"creates other contracts"),"."),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"objectives"},"Objectives"),(0,r.yg)("p",null,"By the end of this lesson you should be able to:"),(0,r.yg)("ul",null,(0,r.yg)("li",{parentName:"ul"},"Write a contract that creates a new contract with the new keyword")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"creating-a-simple-contract-factory"},"Creating a Simple Contract Factory"),(0,r.yg)("p",null,"A contract factory is a contract that creates other contracts. To start, let's create and interact with a very simple one. Create a new project in Remix and add a file called ",(0,r.yg)("inlineCode",{parentName:"p"},"ContractFactory.sol"),"."),(0,r.yg)("h3",{id:"adding-the-template"},"Adding the Template"),(0,r.yg)("p",null,"Imagine you want to create a contract that can store its owner's name and compliment them upon request. You can create this contract fairly easily."),(0,r.yg)("details",null,(0,r.yg)("summary",null,"Reveal code"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-solidity"},'contract Complimenter {\n    string public name;\n\n    constructor(string memory _name) {\n        name = _name;\n    }\n\n    function compliment() public view returns(string memory) {\n        return string.concat("You look great today, ", name);\n    }\n}\n'))),(0,r.yg)("br",null),(0,r.yg)("p",null,"Deploy and test."),(0,r.yg)("h3",{id:"creating-a-factory"},"Creating a Factory"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"Complimenter")," contract is a huge success! People love how it makes them feel and you've got customers banging on the doors and windows. Awesome!"),(0,r.yg)("p",null,"The only problem is that it takes time and effort to manually deploy a new version of the contract for each customer. Luckily, there's a way to write a contract that will act as a self-service portal for your customers."),(0,r.yg)("p",null,"Start by adding a contract called ",(0,r.yg)("inlineCode",{parentName:"p"},"ComplimenterFactory"),". The Remix interface makes things easier if you leave the factory in the same file as ",(0,r.yg)("inlineCode",{parentName:"p"},"Complimenter"),"."),(0,r.yg)("p",null,"Add a function called ",(0,r.yg)("inlineCode",{parentName:"p"},"CreateComplimenter")," that is public, accepts a ",(0,r.yg)("inlineCode",{parentName:"p"},"string")," called ",(0,r.yg)("inlineCode",{parentName:"p"},"_name"),", and returns an ",(0,r.yg)("inlineCode",{parentName:"p"},"address"),"."),(0,r.yg)("p",null,"Creating a new contract is simple: ",(0,r.yg)("inlineCode",{parentName:"p"},"new Complimenter(_name)")),(0,r.yg)("p",null,"You can also save the return from that instantiation into a variable. This reference can be used to call public functions in the deployed contract, and can be cast to an address. We can use it to get an easy reference to find the copies made by the factory. The end result should look similar to:"),(0,r.yg)("details",null,(0,r.yg)("summary",null,"Reveal code"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-solidity"},"contract ComplimenterFactory {\n    function CreateComplimenter(string memory _name) public returns (address) {\n        Complimenter newContract = new Complimenter(_name);\n        return address(newContract);\n    }\n}\n"))),(0,r.yg)("br",null),(0,r.yg)("h3",{id:"testing"},"Testing"),(0,r.yg)("p",null,"Clear the environment if you haven't already, then start by deploying ",(0,r.yg)("inlineCode",{parentName:"p"},"ComplimenterFactory"),". You've been working hard and deserve nice things, so call ",(0,r.yg)("inlineCode",{parentName:"p"},"CreateComplimenter")," with your name."),(0,r.yg)("p",null,"In the terminal, the ",(0,r.yg)("em",{parentName:"p"},"decoded output")," will be the address of the new contract."),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-text"},'{\n    "0": "address: 0x9e0BC6DB02E5aF99b8868f0b732eb45c956B92dD"\n}\n')),(0,r.yg)("p",null,"Copy ",(0,r.yg)("strong",{parentName:"p"},"only")," the address."),(0,r.yg)("p",null,"Switch the ",(0,r.yg)("em",{parentName:"p"},"CONTRACT")," to be deployed to ",(0,r.yg)("inlineCode",{parentName:"p"},"Complimenter"),", then paste the address you copied in the field next to the ",(0,r.yg)("em",{parentName:"p"},"At Address")," button which is below the ",(0,r.yg)("em",{parentName:"p"},"Deploy")," button."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"At address button",src:n(63412).A,width:"317",height:"221"})),(0,r.yg)("p",null,"Click ",(0,r.yg)("em",{parentName:"p"},"At Address")," and the instance of ",(0,r.yg)("inlineCode",{parentName:"p"},"Complimenter")," should appear below ",(0,r.yg)("inlineCode",{parentName:"p"},"ComplimenterFactory"),". Test to confirm it works, then try deploying more instances with the factory."),(0,r.yg)("p",null,(0,r.yg)("img",{alt:"Deployed",src:n(79766).A,width:"312",height:"477"})),(0,r.yg)("admonition",{type:"tip"},(0,r.yg)("p",{parentName:"admonition"},"If the deployed contract appears, but is instead a broken copy of the factory, it's because you didn't change the contract in the ",(0,r.yg)("em",{parentName:"p"},"CONTRACT")," dropdown above the deploy button."),(0,r.yg)("p",{parentName:"admonition"},"Remix is trying to interact with ",(0,r.yg)("inlineCode",{parentName:"p"},"Complimenter")," using the ",(0,r.yg)("em",{parentName:"p"},"ABI")," from the factory contract, which won't work.")),(0,r.yg)("hr",null),(0,r.yg)("h2",{id:"conclusion"},"Conclusion"),(0,r.yg)("p",null,"In this lesson, you learned how to deploy contracts from another contract by using the ",(0,r.yg)("inlineCode",{parentName:"p"},"new")," keyword. You also learned that you look great today!"),(0,r.yg)("hr",null))}y.isMDXComponent=!0},63412:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/at-address-172aa7f1fb124587ad76cd0e0d3312b5.png"},79766:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/deployed-252f28ecb2e667de35109ab2082d73ec.png"}}]);