"use strict";(self.webpackChunk_app_base_docs=self.webpackChunk_app_base_docs||[]).push([[6348],{30876:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>m});var n=a(2784);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),c=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=c(e.components);return n.createElement(s.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},h=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(a),h=r,m=d["".concat(s,".").concat(h)]||d[h]||u[h]||o;return a?n.createElement(m,l(l({ref:t},p),{},{components:a})):n.createElement(m,l({ref:t},p))}));function m(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=h;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[d]="string"==typeof e?e:r,l[1]=i;for(var c=2;c<o;c++)l[c]=a[c];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}h.displayName="MDXCreateElement"},46651:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var n=a(7896),r=(a(2784),a(30876));const o={title:"Accessing real-world data using Chainlink Data Feeds",slug:"/oracles-chainlink-price-feeds",description:"A tutorial that teaches how to use Chainlink Data Feeds to access real-world data, such as asset prices, directly from your smart contracts on the Base testnet.",author:"taycaldwell",keywords:["Oracle Oracles","Chainlink","price feeds","data feeds","smart contract","Base blockchain","Base network","Base testnet","Base test network","app development","dapp development","build a dapp on Base","build on Base"],tags:["oracles"],difficulty:"intermediate",displayed_sidebar:null},l=void 0,i={unversionedId:"docs/oracles-chainlink-price-feeds",id:"docs/oracles-chainlink-price-feeds",title:"Accessing real-world data using Chainlink Data Feeds",description:"A tutorial that teaches how to use Chainlink Data Feeds to access real-world data, such as asset prices, directly from your smart contracts on the Base testnet.",source:"@site/tutorials/docs/2_oracles-chainlink-price-feeds.md",sourceDirName:"docs",slug:"/oracles-chainlink-price-feeds",permalink:"/es/tutorials/oracles-chainlink-price-feeds",draft:!1,tags:[{label:"oracles",permalink:"/es/tutorials/tags/oracles"}],version:"current",sidebarPosition:2,frontMatter:{title:"Accessing real-world data using Chainlink Data Feeds",slug:"/oracles-chainlink-price-feeds",description:"A tutorial that teaches how to use Chainlink Data Feeds to access real-world data, such as asset prices, directly from your smart contracts on the Base testnet.",author:"taycaldwell",keywords:["Oracle Oracles","Chainlink","price feeds","data feeds","smart contract","Base blockchain","Base network","Base testnet","Base test network","app development","dapp development","build a dapp on Base","build on Base"],tags:["oracles"],difficulty:"intermediate",displayed_sidebar:null}},s={},c=[{value:"Objectives",id:"objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Foundry",id:"foundry",level:3},{value:"Coinbase Wallet",id:"coinbase-wallet",level:3},{value:"Wallet funds",id:"wallet-funds",level:3},{value:"What are Chainlink Data Feeds?",id:"what-are-chainlink-data-feeds",level:2},{value:"Creating a project",id:"creating-a-project",level:2},{value:"Installing Chainlink smart contracts",id:"installing-chainlink-smart-contracts",level:2},{value:"Writing and compiling the Smart Contract",id:"writing-and-compiling-the-smart-contract",level:2},{value:"Deploying the smart contract",id:"deploying-the-smart-contract",level:2},{value:"Setting up your wallet as the deployer",id:"setting-up-your-wallet-as-the-deployer",level:3},{value:"Setting up environment variables for Base Goerli",id:"setting-up-environment-variables-for-base-goerli",level:3},{value:"Deploying the smart contract to Base Goerli",id:"deploying-the-smart-contract-to-base-goerli",level:3},{value:"Interacting with the Smart Contract",id:"interacting-with-the-smart-contract",level:2},{value:"Conclusion",id:"conclusion",level:2}],p={toc:c},d="wrapper";function u(e){let{components:t,...a}=e;return(0,r.kt)(d,(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"This tutorial will guide you through the process of creating a smart contract on Base that utilizes Chainlink Data Feeds to access real-world data, such as asset prices, directly from your smart contracts."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"objectives"},"Objectives"),(0,r.kt)("p",null,"By the end of this tutorial you should be able to do the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Set up a smart contract project for Base using Foundry"),(0,r.kt)("li",{parentName:"ul"},"Install the Chainlink smart contracts"),(0,r.kt)("li",{parentName:"ul"},"Consume a Chainlink price data feed within your smart contract"),(0,r.kt)("li",{parentName:"ul"},"Deploy and test your smart contracts on Base")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("h3",{id:"foundry"},"Foundry"),(0,r.kt)("p",null,"This tutorial requires you to have Foundry installed."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"From the command-line (terminal), run: ",(0,r.kt)("inlineCode",{parentName:"li"},"curl -L https://foundry.paradigm.xyz | bash")),(0,r.kt)("li",{parentName:"ul"},"Then run ",(0,r.kt)("inlineCode",{parentName:"li"},"foundryup"),", to install the latest (nightly) build of Foundry")),(0,r.kt)("p",null,"For more information, see the Foundry Book ",(0,r.kt)("a",{parentName:"p",href:"https://book.getfoundry.sh/getting-started/installation"},"installation guide"),"."),(0,r.kt)("h3",{id:"coinbase-wallet"},"Coinbase Wallet"),(0,r.kt)("p",null,"In order to deploy a smart contract, you will first need a wallet. You can create a wallet by downloading the Coinbase Wallet browser extension."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download ",(0,r.kt)("a",{parentName:"li",href:"https://chrome.google.com/webstore/detail/coinbase-wallet-extension/hnfanknocfeofbddgcijnmhnfnkdnaad?hl=en"},"Coinbase Wallet"))),(0,r.kt)("h3",{id:"wallet-funds"},"Wallet funds"),(0,r.kt)("p",null,"Deploying contracts to the blockchain requires a gas fee. Therefore, you will need to fund your wallet with ETH to cover those gas fees."),(0,r.kt)("p",null,"For this tutorial, you will be deploying a contract to the Base Goerli test network. You can fund your wallet with Base Goerli ETH using one of the faucets listed on the Base ",(0,r.kt)("a",{parentName:"p",href:"https://docs.base.org/tools/network-faucets"},"Network Faucets")," page."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"what-are-chainlink-data-feeds"},"What are Chainlink Data Feeds?"),(0,r.kt)("p",null,'Accurate price data is essential in DeFi applications. However, blockchain networks lack the capability to directly fetch external real-world data, leading to the "',(0,r.kt)("a",{parentName:"p",href:"https://chain.link/education-hub/oracle-problem"},"Oracle Problem"),'".'),(0,r.kt)("p",null,"Chainlink Data Feeds offer a solution to this problem by serving as a secure middleware layer that bridges the gap between real-world asset prices and onchain smart contracts."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"creating-a-project"},"Creating a project"),(0,r.kt)("p",null,"Before you can begin writing smart contracts for Base and consuming Chainlink data feeds, you need to set up your development environment by creating a Foundry project."),(0,r.kt)("p",null,"To create a new Foundry project, first create a new directory:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir myproject\n")),(0,r.kt)("p",null,"Then run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cd myproject\nforge init\n")),(0,r.kt)("p",null,"This will create a Foundry project, which has the following basic layout:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},".\n\u251c\u2500\u2500 foundry.toml\n\u251c\u2500\u2500 script\n \u2502   \u2514\u2500\u2500 Counter.s.sol\n\u251c\u2500\u2500 src\n \u2502   \u2514\u2500\u2500 Counter.sol\n\u2514\u2500\u2500 test\n    \u2514\u2500\u2500 Counter.t.sol\n")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"installing-chainlink-smart-contracts"},"Installing Chainlink smart contracts"),(0,r.kt)("p",null,"To use Chainlink's data feeds within your project, you need to install Chainlink smart contracts as a project dependency using ",(0,r.kt)("inlineCode",{parentName:"p"},"forge install"),"."),(0,r.kt)("p",null,"To install Chainlink smart contracts, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"forge install smartcontractkit/chainlink --no-commit\n")),(0,r.kt)("p",null,"Once installed, update your ",(0,r.kt)("inlineCode",{parentName:"p"},"foundry.toml")," file by appending the following line:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"remappings = ['@chainlink/contracts/=lib/chainlink/contracts']\n")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"writing-and-compiling-the-smart-contract"},"Writing and compiling the Smart Contract"),(0,r.kt)("p",null,"Once your project has been created and dependencies have been installed, you can now start writing a smart contract."),(0,r.kt)("p",null,"The Solidity code below defines a smart contract named ",(0,r.kt)("inlineCode",{parentName:"p"},"DataConsumerV3"),". The code uses the ",(0,r.kt)("inlineCode",{parentName:"p"},"AggregatorV3Interface")," interface from the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.chain.link/data-feeds/api-reference#aggregatorv3interface"},"Chainlink contracts library")," to provide access to price feed data."),(0,r.kt)("p",null,"The smart contract passes an address to ",(0,r.kt)("inlineCode",{parentName:"p"},"AggregatorV3Interface"),". This address (",(0,r.kt)("inlineCode",{parentName:"p"},"0xcD2A119bD1F7DF95d706DE6F2057fDD45A0503E2"),") corresponds to the ",(0,r.kt)("inlineCode",{parentName:"p"},"ETH/USD")," price feed on the Base Goerli network."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Chainlink provides a number of price feeds for Base. For a list of available price feeds on Base, visit the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.chain.link/data-feeds/price-feeds/addresses/?network=base&page=1"},"Chainlink documentation"),".")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-solidity"},'   // SPDX-License-Identifier: MIT\n   pragma solidity ^0.8.0;\n\n   import "@chainlink/contracts/src/v0.8/interfaces/AggregatorV3Interface.sol";\n\n   contract DataConsumerV3 {\n       AggregatorV3Interface internal priceFeed;\n\n      /**\n       * Network: Base Goerli\n       * Aggregator: ETH/USD\n       * Address: 0xcD2A119bD1F7DF95d706DE6F2057fDD45A0503E2\n       */\n       constructor() {\n           priceFeed = AggregatorV3Interface(0xcD2A119bD1F7DF95d706DE6F2057fDD45A0503E2);\n       }\n\n       function getLatestPrice() public view returns (int) {\n           (\n               /* uint80 roundID */,\n               int price,\n               /* uint startedAt */,\n               /* uint timeStamp */,\n               /* uint80 answeredInRound */\n           ) = priceFeed.latestRoundData();\n           return price;\n       }\n   }\n')),(0,r.kt)("p",null,"In your project, add the code provided above to a new file named ",(0,r.kt)("inlineCode",{parentName:"p"},"src/DataConsumerV3.sol"),", and delete the ",(0,r.kt)("inlineCode",{parentName:"p"},"src/Counter.sol")," contract that was generated with the project. (you can also delete the ",(0,r.kt)("inlineCode",{parentName:"p"},"test/Counter.t.sol")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"script/Counter.s.sol")," files)."),(0,r.kt)("p",null,"To compile the new smart contract, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"forge build\n")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"deploying-the-smart-contract"},"Deploying the smart contract"),(0,r.kt)("h3",{id:"setting-up-your-wallet-as-the-deployer"},"Setting up your wallet as the deployer"),(0,r.kt)("p",null,"Before you can deploy your smart contract to the Base network, you will need to set up a wallet to be used as the deployer."),(0,r.kt)("p",null,"To do so, you can use the ",(0,r.kt)("a",{parentName:"p",href:"https://book.getfoundry.sh/reference/cast/cast-wallet-import"},(0,r.kt)("inlineCode",{parentName:"a"},"cast wallet import"))," command to import the private key of the wallet into Foundry's securely encrypted keystore:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cast wallet import deployer --interactive\n")),(0,r.kt)("p",null,"After running the command above, you will be prompted to enter your private key, as well as a password for signing transactions."),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"For instructions on how to get your private key from Coinbase Wallet, visit the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.cloud.coinbase.com/wallet-sdk/docs/developer-settings#show-private-key"},"Coinbase Wallet documentation"),"."),(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("strong",{parentName:"p"},"It is critical that you do NOT commit this to a public repo"),".")),(0,r.kt)("p",null,"To confirm that the wallet was imported as the ",(0,r.kt)("inlineCode",{parentName:"p"},"deployer")," account in your Foundry project, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"cast wallet list\n")),(0,r.kt)("h3",{id:"setting-up-environment-variables-for-base-goerli"},"Setting up environment variables for Base Goerli"),(0,r.kt)("p",null,"To setup your environment for deploying to the Base network, create an ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file in the home directory of your project, and add the RPC URL for the Base Goerli testnet:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'BASE_GOERLI_RPC="https://goerli.base.org"\n')),(0,r.kt)("p",null,"Once the ",(0,r.kt)("inlineCode",{parentName:"p"},".env")," file has been created, run the following command to load the environment variables in the current command line session:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"source .env\n")),(0,r.kt)("h3",{id:"deploying-the-smart-contract-to-base-goerli"},"Deploying the smart contract to Base Goerli"),(0,r.kt)("p",null,"With your contract compiled and environment setup, you are ready to deploy the smart contract to the Base Goerli Testnet!"),(0,r.kt)("p",null,"For deploying a single smart contract using Foundry, you can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"forge create")," command. The command requires you to specify the smart contract you want to deploy, an RPC URL of the network you want to deploy to, and the account you want to deploy with."),(0,r.kt)("p",null,"To deploy the ",(0,r.kt)("inlineCode",{parentName:"p"},"DataConsumerV3")," smart contract to the Base Goerli test network, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"forge create ./src/DataConsumerV3.sol:DataConsumerV3 --rpc-url $BASE_GOERLI_RPC --account deployer\n")),(0,r.kt)("p",null,"When prompted, enter the password that you set earlier, when you imported your wallet's private key."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Your wallet must be funded with ETH on the Base Goerli Testnet to cover the gas fees associated with the smart contract deployment. Otherwise, the deployment will fail."),(0,r.kt)("p",{parentName:"admonition"},"To get testnet ETH for Base Goerli, see the ",(0,r.kt)("a",{parentName:"p",href:"#prerequisites"},"prerequisites"),".")),(0,r.kt)("p",null,"After running the command above, the contract will be deployed on the Base Goerli test network. You can view the deployment status and contract by using a ",(0,r.kt)("a",{parentName:"p",href:"/tools/block-explorers"},"block explorer"),"."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"interacting-with-the-smart-contract"},"Interacting with the Smart Contract"),(0,r.kt)("p",null,"Foundry provides the ",(0,r.kt)("inlineCode",{parentName:"p"},"cast")," command-line tool that can be used to interact with the smart contract that was deployed and call the ",(0,r.kt)("inlineCode",{parentName:"p"},"getLatestPrice()")," function to fetch the latest price of ETH."),(0,r.kt)("p",null,"To call the ",(0,r.kt)("inlineCode",{parentName:"p"},"getLatestPrice()")," function of the smart contract, run:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'cast call <DEPLOYED_ADDRESS> --rpc-url $BASE_GOERLI_RPC "getLatestPrice()"\n')),(0,r.kt)("p",null,"You should receive the latest ",(0,r.kt)("inlineCode",{parentName:"p"},"ETH / USD")," price in hexadecimal form."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"Congratulations! You have successfully deployed and interacted with a smart contract that consumes a Chainlink price feed on the Base blockchain network."),(0,r.kt)("p",null,"To learn more about Oracles and using Chainlink to access real-world data within your smart contracts on Base, check out the following resources:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.base.org/tools/oracles"},"Oracles")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"https://docs.chain.link/data-feeds/price-feeds/addresses?network=base&page=1&search=#networks"},"Chainlink Data Feeds on Base"))))}u.isMDXComponent=!0}}]);