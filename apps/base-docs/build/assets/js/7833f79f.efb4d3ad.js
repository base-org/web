"use strict";(self.webpackChunk_app_base_docs=self.webpackChunk_app_base_docs||[]).push([[5278],{30876:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>k});var a=n(2784);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),s=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(p.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),c=s(n),h=o,k=c["".concat(p,".").concat(h)]||c[h]||d[h]||i;return n?a.createElement(k,l(l({ref:t},u),{},{components:n})):a.createElement(k,l({ref:t},u))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,l=new Array(i);l[0]=h;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r[c]="string"==typeof e?e:o,l[1]=r;for(var s=2;s<i;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},49377:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>s});var a=n(7896),o=(n(2784),n(30876));const i={title:"Deploy an Onchain App with Fleek",slug:"/deploy-with-fleek",description:"Learn how to deploy an onchain app using Fleek.",author:"briandoyle81",keywords:["deploy","fleek","onchain","dapp","onchain app"],tags:["frontend"],difficulty:"hard",hide_table_of_contents:!1,displayed_sidebar:null},l=void 0,r={unversionedId:"docs/deploy-with-fleek",id:"docs/deploy-with-fleek",title:"Deploy an Onchain App with Fleek",description:"Learn how to deploy an onchain app using Fleek.",source:"@site/tutorials/docs/0_deploy-with-fleek.md",sourceDirName:"docs",slug:"/deploy-with-fleek",permalink:"/tutorials/deploy-with-fleek",draft:!1,tags:[{label:"frontend",permalink:"/tutorials/tags/frontend"}],version:"current",sidebarPosition:0,frontMatter:{title:"Deploy an Onchain App with Fleek",slug:"/deploy-with-fleek",description:"Learn how to deploy an onchain app using Fleek.",author:"briandoyle81",keywords:["deploy","fleek","onchain","dapp","onchain app"],tags:["frontend"],difficulty:"hard",hide_table_of_contents:!1,displayed_sidebar:null}},p={},s=[{value:"Objectives",id:"objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Next.js",id:"nextjs",level:3},{value:"Onchain Apps",id:"onchain-apps",level:3},{value:"Setting up the Template",id:"setting-up-the-template",level:2},{value:"Installing and Configuring Fleek",id:"installing-and-configuring-fleek",level:2},{value:"Deployment",id:"deployment",level:3},{value:"Dashboard Overview and Confirming Deployment",id:"dashboard-overview-and-confirming-deployment",level:2},{value:"Conclusion",id:"conclusion",level:2}],u={toc:s},c="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(c,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,'One of the "secrets" of onchain apps is that they almost always have a very large web2 component that they\'re dependent on. Most onchain apps rely on traditional infrastructure for their frontends, APIs, and other parts of the architecture.'),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://fleek.xyz"},"Fleek"),"'s goal is to address this issue with the ",(0,o.kt)("a",{parentName:"p",href:"https://fleek.xyz/blog/announcements/introducing-fleek-network-and-fleek-xyz/"},"Fleek Network"),", a fast and trustless Content Delivery Network (CDN)."),(0,o.kt)("p",null,"In this tutorial, you'll use ",(0,o.kt)("a",{parentName:"p",href:"https://fleek.xyz"},"Fleek")," to deploy a site built with the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Zizzamia/an-onchain-app-in-100-components"},"An Onchain App in 100 Components")," template."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"objectives"},"Objectives"),(0,o.kt)("p",null,"By the end of this tutorial you should be able to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Deploy a ",(0,o.kt)("a",{parentName:"li",href:"https://nextjs.org/"},"Next.js")," using the Coinbase ",(0,o.kt)("a",{parentName:"li",href:"https://www.smartwallet.dev/why"},"Smart Wallet")," on ",(0,o.kt)("a",{parentName:"li",href:"https://fleek.xyz"},"Fleek")),(0,o.kt)("li",{parentName:"ul"},"Integrate with ","[Github]"," for CI/CD")),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("h3",{id:"nextjs"},"Next.js"),(0,o.kt)("p",null,"You should be familiar with ",(0,o.kt)("a",{parentName:"p",href:"https://nextjs.org/"},"Next.js"),", but do not need to be an expert. If you are comfortable with other React libraries, the pattern should be relatively easy to follow."),(0,o.kt)("h3",{id:"onchain-apps"},"Onchain Apps"),(0,o.kt)("p",null,"The tutorial assumes you're comfortable with the basics of deploying an app and connecting it to a smart contract. If you're still learning this part, check out our tutorials in ",(0,o.kt)("a",{parentName:"p",href:"https://base.org.camp"},"Base Camp")," for ","[Building an Onchain App]","."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"setting-up-the-template"},"Setting up the Template"),(0,o.kt)("p",null,"You can skip this section if you've already built an app based off the template, such as our tutorial for ",(0,o.kt)("a",{parentName:"p",href:"/tutorials/minting-nfts-with-zora"},"How to Mint on Zora with an App"),"."),(0,o.kt)("p",null,"Open ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Zizzamia/an-onchain-app-in-100-components"},"An Onchain App in 100 Components"),", click the green ",(0,o.kt)("inlineCode",{parentName:"p"},"Use  this template")," button, and create a new repository from the template. Clone your repo and open it in an editor."),(0,o.kt)("p",null,"Install ",(0,o.kt)("em",{parentName:"p"},"bun")," if you need to, and install dependencies."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Install bun in case you don't have it\ncurl -fsSL https://bun.sh/install | bash\n\n# Install packages\nbun i\n\n# Run Next app\nbun run dev\n")),(0,o.kt)("p",null,"Navigate to ",(0,o.kt)("inlineCode",{parentName:"p"},"localhost:3000")," and make sure that it's working, then shut down the server. For this tutorial, you ",(0,o.kt)("strong",{parentName:"p"},"do not")," need to set any environment variables."),(0,o.kt)("h2",{id:"installing-and-configuring-fleek"},"Installing and Configuring Fleek"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://fleek.xyz"},"Fleek")," requires static pages, so you'll need to ensure that your build process produces them. In your editor, open ",(0,o.kt)("inlineCode",{parentName:"p"},"next.config.js")," and update the ",(0,o.kt)("inlineCode",{parentName:"p"},"nextConfig"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-javascript"},"/** @type {import('next').NextConfig} */\nconst nextConfig = {\n  output: 'export',\n  reactStrictMode: true,\n  images: {\n    unoptimized: true,\n  },\n  trailingSlash: true,\n};\n\nmodule.exports = nextConfig;\n")),(0,o.kt)("p",null,"Save and close the file."),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"bun run build")," and confirm that a directory called ",(0,o.kt)("inlineCode",{parentName:"p"},"out")," is created."),(0,o.kt)("p",null,"Navigate to ",(0,o.kt)("a",{parentName:"p",href:"https://fleek.xyz"},"Fleek"),"'s website and create an account, or log in if you already have one."),(0,o.kt)("p",null,"Click into ",(0,o.kt)("inlineCode",{parentName:"p"},"First Project"),". You can rename it if you want in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Settings")," tab."),(0,o.kt)("p",null,"The best way to start is to link Fleek to your repo from the beginning. Click ",(0,o.kt)("inlineCode",{parentName:"p"},"Add New")," from the upper right corner, then select ",(0,o.kt)("inlineCode",{parentName:"p"},"Deploy My Site"),". Select your code location, log into your Git provider, and accept installing the Fleek app."),(0,o.kt)("p",null,"You can either give it permissions for all repos, or add them one at a time."),(0,o.kt)("p",null,"Select your repo, and click the ",(0,o.kt)("inlineCode",{parentName:"p"},"Deploy")," button. The ",(0,o.kt)("inlineCode",{parentName:"p"},"Configure Site")," window should automatically populate with the appropriate information, but just in case:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Site Name: Your site name"),(0,o.kt)("li",{parentName:"ul"},"Framework: Next.js"),(0,o.kt)("li",{parentName:"ul"},"Branch: main"),(0,o.kt)("li",{parentName:"ul"},"Publish Directory: out"),(0,o.kt)("li",{parentName:"ul"},"Build Command: npm install && npm run build")),(0,o.kt)("p",null,"Click ",(0,o.kt)("inlineCode",{parentName:"p"},"Deploy Site"),". Your deploy will probably fail, but this is expected!"),(0,o.kt)("p",null,"Return to your code editor."),(0,o.kt)("p",null,"Open a terminal and install the Fleek CLI with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"npm install -g @fleek-platform/cli\n")),(0,o.kt)("p",null,"Then, ",(0,o.kt)("strong",{parentName:"p"},"in the root of your project")," run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"fleek login\n")),(0,o.kt)("p",null,"Click the link in your terminal, then click ",(0,o.kt)("inlineCode",{parentName:"p"},"Confirm")," in the web page that opens up. Once your are connected, click the ",(0,o.kt)("inlineCode",{parentName:"p"},"Visit Dashboard")," button. The site automatically creates a project called ",(0,o.kt)("inlineCode",{parentName:"p"},"First Project"),". If you'd like, you can rename it, or add a new one."),(0,o.kt)("p",null,"Each project can include more than one site."),(0,o.kt)("p",null,"Return to your terminal in the app folder, and run:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"fleek sites init\n")),(0,o.kt)("p",null,"Select ",(0,o.kt)("inlineCode",{parentName:"p"},"First Project")," from the list"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'\u26a0\ufe0f Warning! To proceed, please select a project...\n\n\u2714 Select a project from the list: \u203a First Project\n\n\u2705 Success! You have switched to project "First Project".\n')),(0,o.kt)("p",null,"For ",(0,o.kt)("inlineCode",{parentName:"p"},"We've found existing sites. Would you like to link to one of them?"),", pick: ",(0,o.kt)("inlineCode",{parentName:"p"},"Y")),(0,o.kt)("p",null,"Find the site you just added and select it."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"You're using TypeScript, but ",(0,o.kt)("strong",{parentName:"p"},"do not")," select ",(0,o.kt)("inlineCode",{parentName:"p"},"TypeScript (fleek.config.ts)")," in the final prompt. Select ",(0,o.kt)("inlineCode",{parentName:"p"},"JSON (fleek.config.json)"),".")),(0,o.kt)("p",null,"You'll get a few more prompts:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"? Please specify the directory containing the site files to be uploaded",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Enter ",(0,o.kt)("inlineCode",{parentName:"li"},"out")))),(0,o.kt)("li",{parentName:"ul"},'? Would you like to include the optional "build" command?',(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Pick ",(0,o.kt)("inlineCode",{parentName:"li"},"Y")))),(0,o.kt)("li",{parentName:"ul"},"? Specify ",(0,o.kt)("inlineCode",{parentName:"li"},"build")," command:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Enter ",(0,o.kt)("inlineCode",{parentName:"li"},"npm install && npm run build")),(0,o.kt)("li",{parentName:"ul"},"Select ",(0,o.kt)("inlineCode",{parentName:"li"},"JSON (fleek.config.json)"))))),(0,o.kt)("h3",{id:"deployment"},"Deployment"),(0,o.kt)("p",null,"You can deploy the site from the CLI as the docs describe, but you ",(0,o.kt)("strong",{parentName:"p"},"do not need to"),". There is a better way!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Don't use, better method below!\nfleek sites deploy\n")),(0,o.kt)("p",null,"Instead, trigger an automatic deploy by making a change to the text at ",(0,o.kt)("inlineCode",{parentName:"p"},"src/app/page.tsx"),", committing your changes, and pushing to your repo."),(0,o.kt)("h2",{id:"dashboard-overview-and-confirming-deployment"},"Dashboard Overview and Confirming Deployment"),(0,o.kt)("p",null,"Return to your dashboard and click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"Sites")," tab. Click on the card for your new site to open it. Here, you can see information about your site in a similar presentation to other deployment providers."),(0,o.kt)("p",null,"Click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"<-> Deploys")," tab and you'll see the automatic deploy you triggered by pushing the commit! Open your site by clicking on the build once it shifts from ",(0,o.kt)("inlineCode",{parentName:"p"},"Pending")," to ",(0,o.kt)("inlineCode",{parentName:"p"},"Live"),". You can then click on the link to view your site."),(0,o.kt)("p",null,"Click on ",(0,o.kt)("inlineCode",{parentName:"p"},"Settings"),". If you'd like, you can change the slug for your site to a name that's more related to your project."),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"In this tutorial, you learned how to use ",(0,o.kt)("a",{parentName:"p",href:"https://fleek.xyz"},"Fleek")," to deploy a ",(0,o.kt)("a",{parentName:"p",href:"https://nextjs.org/"},"Next.js")," site based on ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Zizzamia/an-onchain-app-in-100-components"},"An Onchain App in 100 Components"),". You also learned how to link Fleek to your Git provider to enable CI/CD."),(0,o.kt)("hr",null))}d.isMDXComponent=!0}}]);