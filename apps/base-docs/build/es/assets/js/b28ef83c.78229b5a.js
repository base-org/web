"use strict";(self.webpackChunk_app_base_docs=self.webpackChunk_app_base_docs||[]).push([[7206],{30876:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(2784);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var c=n.createContext({}),l=function(e){var t=n.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},p=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,c=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=l(a),d=o,h=u["".concat(c,".").concat(d)]||u[d]||m[d]||r;return a?n.createElement(h,s(s({ref:t},p),{},{components:a})):n.createElement(h,s({ref:t},p))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,s=new Array(r);s[0]=d;var i={};for(var c in t)hasOwnProperty.call(t,c)&&(i[c]=t[c]);i.originalType=e,i[u]="string"==typeof e?e:o,s[1]=i;for(var l=2;l<r;l++)s[l]=a[l];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},40520:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>m,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var n=a(7896),o=(a(2784),a(30876));const r={title:"Farcaster Cast Actions: Create a Simple Cast Action",slug:"/farcaster-cast-actions-simple",description:"A tutorial that teaches how to make a simple Farcaster cast action.",author:"briandoyle81",keywords:["farcaster","cast actions","farcaster cast actions","farcaster actions"],tags:["frames","actions"],difficulty:"beginner",hide_table_of_contents:!1,displayed_sidebar:null},s=void 0,i={unversionedId:"docs/farcaster-cast-actions-simple",id:"docs/farcaster-cast-actions-simple",title:"Farcaster Cast Actions: Create a Simple Cast Action",description:"A tutorial that teaches how to make a simple Farcaster cast action.",source:"@site/tutorials/docs/5_farcaster-cast-actions-simple.md",sourceDirName:"docs",slug:"/farcaster-cast-actions-simple",permalink:"/es/tutorials/farcaster-cast-actions-simple",draft:!1,tags:[{label:"frames",permalink:"/es/tutorials/tags/frames"},{label:"actions",permalink:"/es/tutorials/tags/actions"}],version:"current",sidebarPosition:5,frontMatter:{title:"Farcaster Cast Actions: Create a Simple Cast Action",slug:"/farcaster-cast-actions-simple",description:"A tutorial that teaches how to make a simple Farcaster cast action.",author:"briandoyle81",keywords:["farcaster","cast actions","farcaster cast actions","farcaster actions"],tags:["frames","actions"],difficulty:"beginner",hide_table_of_contents:!1,displayed_sidebar:null}},c={},l=[{value:"Objectives",id:"objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Vercel",id:"vercel",level:3},{value:"Farcaster",id:"farcaster",level:3},{value:"Setup",id:"setup",level:2},{value:"Creating A Simple Cast Action",id:"creating-a-simple-cast-action",level:2},{value:"Testing the Cast Action",id:"testing-the-cast-action",level:3},{value:"Performing a Task in the Cast Action",id:"performing-a-task-in-the-cast-action",level:2},{value:"Installing the Cast Action",id:"installing-the-cast-action",level:2},{value:"From a Web Page",id:"from-a-web-page",level:3},{value:"From a Frame",id:"from-a-frame",level:3},{value:"Conclusion",id:"conclusion",level:2}],p={toc:l},u="wrapper";function m(e){let{components:t,...r}=e;return(0,o.kt)(u,(0,n.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://warpcast.notion.site/Spec-Farcaster-Actions-84d5a85d479a43139ea883f6823d8caa"},"Cast Actions")," are a new feature of ",(0,o.kt)("a",{parentName:"p",href:"https://www.farcaster.xyz/"},"Farcaster")," that enable you to create actions that users can install on their Farcaster client and then click a button on any cast to trigger the action. In this tutorial, you'll learn how to build a simple cast action with ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/coinbase/onchainkit"},"OnchainKit")," that returns a message to the Farcaster client."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Cast Actions are brand new and tools for building them are evolving quickly. Check the ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.notion.site/Spec-Farcaster-Actions-84d5a85d479a43139ea883f6823d8caa"},"Cast Actions")," docs and OnchainKit ","[changelog]","!")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"objectives"},"Objectives"),(0,o.kt)("p",null,"By the end of this tutorial you should be able to:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Create a Farcaster cast action that returns a message when triggered by a user"),(0,o.kt)("li",{parentName:"ul"},"Identify the location to add additional functionality to the cast"),(0,o.kt)("li",{parentName:"ul"},"Enable users to install the cast action")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("h3",{id:"vercel"},"Vercel"),(0,o.kt)("p",null,"You'll need to be comfortable deploying your app to ",(0,o.kt)("a",{parentName:"p",href:"https://vercel.com"},"Vercel"),", or using another solution on your own. If you need a refresher, check out our tutorial on ",(0,o.kt)("a",{parentName:"p",href:"/tutorials/farcaster-frames-deploy-to-vercel"},"deploying with Vercel"),"!"),(0,o.kt)("h3",{id:"farcaster"},"Farcaster"),(0,o.kt)("p",null,"You must have a ",(0,o.kt)("a",{parentName:"p",href:"https://www.farcaster.xyz/"},"Farcaster")," account with a connected wallet. Check out the ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.com/~/channel/base"},"Base channel")," to stay in the loop when we release tutorials like this!"),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("p",null,"Create a copy of ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/Zizzamia/a-frame-in-100-lines"},"a-frame-in-100-lines"),". It's a template, so you can easily add a new copy by clicking the green button at the top of the page. If you're working off of an existing copy, check to make sure you have the most up-to-date version of ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/coinbase/onchainkit"},"OnchainKit"),"!"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"yarn install"),"."),(0,o.kt)("p",null,"Cast actions need to be deployed to a server to work, so connect your repo to ",(0,o.kt)("a",{parentName:"p",href:"https://vercel.com"},"Vercel")," with CI/CD. Remember that while doing so does make it much easier to test and redeploy, it also makes it easier to break a live cast action!"),(0,o.kt)("p",null,"Open ",(0,o.kt)("inlineCode",{parentName:"p"},"app/config.ts")," and update ",(0,o.kt)("inlineCode",{parentName:"p"},"NEXT_PUBLIC_URL")," to your new deployment."),(0,o.kt)("h2",{id:"creating-a-simple-cast-action"},"Creating A Simple Cast Action"),(0,o.kt)("p",null,"Cast actions work similarly to the way ",(0,o.kt)("a",{parentName:"p",href:"https://docs.farcaster.xyz/learn/what-is-farcaster/frames"},"Frames")," call your api endpoint. As a result, you can quickly adapt the code of an endpoint expecting a frame to instead manage a cast action."),(0,o.kt)("p",null,"Add a new folder in ",(0,o.kt)("inlineCode",{parentName:"p"},"api")," called ",(0,o.kt)("inlineCode",{parentName:"p"},"action")," with a file called ",(0,o.kt)("inlineCode",{parentName:"p"},"route.ts")," to create a new route in your app. Import dependencies from OnchainKit and Next.js:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"import { FrameRequest, getFrameMessage } from '@coinbase/onchainkit/frame';\nimport { NextRequest, NextResponse } from 'next/server';\n")),(0,o.kt)("p",null,"You won't be returning a frame, so you don't need ",(0,o.kt)("inlineCode",{parentName:"p"},"getFrameHtmlResponse"),"."),(0,o.kt)("p",null,"Stub out your ",(0,o.kt)("inlineCode",{parentName:"p"},"POST")," handler and response function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"async function getResponse(req: NextRequest): Promise<NextResponse> {\n  // TODO\n}\n\nexport async function POST(req: NextRequest): Promise<Response> {\n  console.log('POST');\n  return getResponse(req);\n}\n\nexport async function GET(req: NextRequest): Promise<Response> {\n  console.log('GET');\n  return getResponse(req);\n}\n\nexport const dynamic = 'force-dynamic';\n")),(0,o.kt)("p",null,"Parse and validate the request exactly the same as you would a frame in the top of ",(0,o.kt)("inlineCode",{parentName:"p"},"getResponse"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const body: FrameRequest = await req.json();\nconst { isValid, message } = await getFrameMessage(body, { neynarApiKey: 'NEYNAR_ONCHAIN_KIT' });\n\nif (!isValid) {\n  return new NextResponse('Message not valid', { status: 500 });\n}\n")),(0,o.kt)("p",null,"Instead of returning a frame, you'll return a json ",(0,o.kt)("inlineCode",{parentName:"p"},"NextResponse")," with a string ",(0,o.kt)("inlineCode",{parentName:"p"},"message")," and a 200 status:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"return NextResponse.json({ message: 'Hello from the frame route' }, { status: 200 });\n")),(0,o.kt)("h3",{id:"testing-the-cast-action"},"Testing the Cast Action"),(0,o.kt)("p",null,"Commit your work to trigger a deploy in ",(0,o.kt)("a",{parentName:"p",href:"https://vercel.com"},"Vercel"),". Once it's done, you can test your cast action with the ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.com/~/developers/cast-actions?icon=home&name=Random+City+Name&postUrl=https%3A%2F%2F660b36e4ccda4cbc75dc8ec2.mockapi.io%2Fcity"},"Cast Actions Playground"),"."),(0,o.kt)("p",null,"The above link has an example embedded in it. Try it out, then replace the ",(0,o.kt)("inlineCode",{parentName:"p"},"Post URL")," with your own. Click ",(0,o.kt)("inlineCode",{parentName:"p"},"Submit Action")," and you will see the hello message from your route."),(0,o.kt)("h2",{id:"performing-a-task-in-the-cast-action"},"Performing a Task in the Cast Action"),(0,o.kt)("p",null,"Before sending the response, you can do whatever you want to give your cast action functionality. Possibilities include:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Extracting the cast hash or caster FID from the request and using it for something"),(0,o.kt)("li",{parentName:"ul"},"Reading or writing from a database or smart contract"),(0,o.kt)("li",{parentName:"ul"},"Anything else you'd use an API call to do on behalf of a user")),(0,o.kt)("p",null,"For now, you can add a simple addition to let the user know what time it is."),(0,o.kt)("p",null,"Modify your ",(0,o.kt)("inlineCode",{parentName:"p"},"return"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"// Get the current date and time\nconst now = new Date();\nconst date = now.toLocaleDateString();\nconst time = now.toLocaleTimeString();\n\n// Format them as a string\nconst dateTime = `${date} ${time} UTC`;\n\nreturn NextResponse.json({ message: dateTime }, { status: 200 });\n")),(0,o.kt)("h2",{id:"installing-the-cast-action"},"Installing the Cast Action"),(0,o.kt)("p",null,"To install a cast action, you need to pick an ",(0,o.kt)("a",{parentName:"p",href:"https://primer.style/foundations/icons/"},"Octicon")," from the list at the bottom of the ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.notion.site/Spec-Farcaster-Actions-84d5a85d479a43139ea883f6823d8caa"},"Cast Actions")," doc. You also need to decide on a name for your action. Using those, you create a deeplink to Warpcast that will prompt the user to install your action. Currently, this replaces their existing action, but the capacity for multiple will be added soon."),(0,o.kt)("p",null,"For example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-text"},"https://warpcast.com/~/add-cast-action?actionType=post&name=Current+Time&icon=clock&postUrl=https%3A%2F%2Ftest-cast-actions.vercel.app%2Fapi%2Faction\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.com/~/developers/cast-actions?icon=home&name=Random+City+Name&postUrl=https%3A%2F%2F660b36e4ccda4cbc75dc8ec2.mockapi.io%2Fcity"},"Cast Actions Playground")," has a nice tool to build this link for you!"),(0,o.kt)("h3",{id:"from-a-web-page"},"From a Web Page"),(0,o.kt)("p",null,"To enable your users to install your action from a web page, simply include the link. Update the root of your site to do so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},'export default function Page() {\n  return (\n    <>\n      <div>\n        <a href="https://warpcast.com/~/add-cast-action?actionType=post&name=Current+Time&icon=clock&postUrl=https%3A%2F%2Ftest-cast-actions.vercel.app%2Fapi%2Faction">\n          Click here to install the Current Time action on Warpcast.\n        </a>\n      </div>\n    </>\n  );\n}\n')),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Install Action",src:a(8302).Z,width:"1024",height:"258"})),(0,o.kt)("h3",{id:"from-a-frame"},"From a Frame"),(0,o.kt)("p",null,"Finally, update the frame on your root page to also have the install link:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-tsx"},"const frameMetadata = getFrameMetadata({\n  buttons: [\n    {\n      action: 'link',\n      label: 'Add Current Time Action',\n      target:\n        'https://warpcast.com/~/add-cast-action?actionType=post&name=Current+Time&icon=clock&postUrl=https%3A%2F%2Ftest-cast-actions.vercel.app%2Fapi%2Faction',\n    },\n  ],\n  image: {\n    src: `${NEXT_PUBLIC_URL}/park-3.png`,\n    aspectRatio: '1:1',\n  },\n});\n")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"conclusion"},"Conclusion"),(0,o.kt)("p",null,"In this tutorial, you created a ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.notion.site/Spec-Farcaster-Actions-84d5a85d479a43139ea883f6823d8caa"},"Farcaster")," that allows your users to get the current date and time from a cast. You also learned where and how you can add further functionality to your action. Finally, you created a link and a frame to allow your users to install your cast action."),(0,o.kt)("p",null,"Watch the ",(0,o.kt)("a",{parentName:"p",href:"https://warpcast.com/~/channel/base"},"Base Channel")," to stay up-to-date on new developments!"),(0,o.kt)("hr",null))}m.isMDXComponent=!0},8302:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/install-action-b8fb5be7fcd85a7bf66358ae64336e79.png"}}]);